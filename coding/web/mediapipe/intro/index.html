<!DOCTYPE html>
<html class="no-js" lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>AI e Teachable Machine - Lab. informatica</title>

    <meta name="description" content="Introduzione all&#39;intelligenza artificiale e a Teachable Machine">
        <meta property="og:url" content="http://codingepaduli.github.io/coding/web/mediapipe/intro/">
  <meta property="og:site_name" content="Lab. informatica">
  <meta property="og:title" content="AI e Teachable Machine">
  <meta property="og:description" content="Introduzione all&#39;intelligenza artificiale e a Teachable Machine">
  <meta property="og:locale" content="it_IT">
  <meta property="og:type" content="article">
    <meta property="article:section" content="coding">
    <meta property="article:published_time" content="2022-03-28T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-03-28T00:00:00+00:00">
    <meta property="og:image" content="http://codingepaduli.github.io/static/wifi-5.svg">

        
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://codingepaduli.github.io/static/wifi-5.svg">
  <meta name="twitter:title" content="AI e Teachable Machine">
  <meta name="twitter:description" content="Introduzione all&#39;intelligenza artificiale e a Teachable Machine">



    <link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="/static/css/customTypography.css">
    

    <link rel="icon" href="/favicon.ico">
    <link rel="icon" href="/static/wifi-5.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/static/apple-touch-icon.png">
    <link rel="manifest" href="/static/manifest.webmanifest">

    
        <meta name="keywords" content="coding  programmazione  open-source  sviluppo  web  ">
</head>
<body class="body">
    <div class="container container--outer">
        <header class="header">
	<div class="container header__container">
		
	
	<div class="logo">

    
    <div id="my_logo">

      
      <div>
        <a class="logo__link" href="/" title="Lab. informatica" rel="home">
      		</a>
      </div>

      
      <div class="logo__item">
        <div class="logo__title">
          <a href="/" style="color: #e22d30">
            Lab. informatica
          </a>
        </div>
      </div>




      
      <div>
        

  <div class="menu_button">
    
    <label for="my_menu">
      Menu
      <span></span>
      <span></span>
      <span></span>
    </label>
  </div>

      </div>
    </div>
    

    <style>
       
      #my_logo {
        display: flex;
        justify-content: space-between;  
        align-items: center;  
      }
    </style>

    
    <div class="logo__item logo__text" style="display: block; text-align: center;">
			<div class="logo__tagline" style="color: inherit;">Sito web del laboratorio di informatica</div>
		</div>
  </div>

  

  
  <input type="checkbox" id="my_menu">


		

  <nav class="my_navbar">
    <ul>

      <li><a href="/coding/">Coding</a></li>

      <li><a href="/tools/">Tools</a></li>

      <li><a href="/opensource/">Software open source</a></li>

      <li><a href="/webapp/">Web-App</a></li>

      <li><a href="/interesting/">Link interessanti</a></li>
    </ul>
  </nav>

	</div>
</header>



  <style>
     
    .my_navbar ul {
      display: flex;  
      background-color: black;
      color: white;
    }
    .my_navbar li {
      padding: 0.8rem 1.5rem;
      list-style: none;
      text-transform: uppercase;
      justify-content: center;
    }
    .my_navbar a {
      color: white;
      font-weight: 700;
    }

     
    @media screen and (max-width: 767px) {
      .my_navbar ul {
         flex-direction: column;
         display: none;  
      }

       
       
      #my_menu:checked + .my_navbar ul {
         display: flex;
         text-align: center;
      }
    }
  </style>



  <style>
     
    .menu_button {
      display: none;
    }
    .menu_button label {
      background-color: white;
      color: black;
      border: 2px solid white;
      height: 70px;
      width: 70px;
      display: flex;  
      justify-content: center;
      align-items: center;  
      flex-direction: column;
    }
     
    .menu_button label span {
      background-color: black;
      color: white;
      height: 3px;
      width: 80%;
      margin: 5px 0px;
    }

     
    @media screen and (max-width: 767px) {
      .menu_button {
        display: flex;  
        justify-content: flex-end;  
      }
    }
  </style>



  
  <style>
    #my_menu {
      display: none;  
    }
  </style>


        <div class="wrapper flex">
            <div class="primary">
            
<style>
    :fullscreen {
        overflow-x :hidden;
        overflow-y: hidden;
    }
</style>

<main class="main" role="main">
  <article class="post">
    <header class="post__header">
      
      <div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2022-03-28T00:00:00Z">28-03-2022</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/coding/" rel="category">Coding</a>, <a class="meta__link" href="/categories/web/" rel="category">Web</a>, <a class="meta__link" href="/categories/ai/" rel="category">Ai</a>
	</span>
</div><div class="meta__item-reading meta__item">
    
	<span class="meta__text">
        Tempo di lettura 10 minuti 
        ( 2073 parole)
    </span>
</div></div>
    </header>
<div class="content post__content clearfix">
      <h1 id="ai-e-teachable-machine">AI e Teachable Machine</h1>
<p>L&rsquo;intelligenza artificiale è un ramo della computer science che si occupa di creare sistemi in grado di svolgere compiti che normalmente richiederebbero intelligenza umana. Questi compiti possono includere il riconoscimento vocale, la comprensione del linguaggio naturale, la visione artificiale e la presa di decisioni.</p>
<p>Possiamo dire che gli algoritmi di intelligenza artificiale simulano il comportamento umano.</p>
<p>Si basa sul machine learning (apprendimento automatico), un campo di studio che consente ai computer di imparare senza scrivere esplicitamente il programma per risolvere il problema, bensì utilizzando dei dati dai quali apprendere.</p>
<p>Le tecniche di machine learning si dividono in supervisionate o non supervisionate.</p>
<h2 id="apprendimento-supervisionato">Apprendimento supervisionato</h2>
<p>L&rsquo;apprendimento supervisionato si riferisce ad algoritmi che imparano dai dati etichettati, mappando l&rsquo;ingresso (X) all&rsquo;output (Y). Ciò significa che l&rsquo;algoritmo è fornito con esempi da cui imparare prima di fare previsioni.</p>
<p>L&rsquo;apprendimento supervisionato è classificato in due tipi principali: regressione e classificazione.</p>
<ul>
<li>La regressione viene utilizzata quando l&rsquo;obiettivo è quello di &ldquo;prevedere&rdquo; o &ldquo;calcolare&rdquo; un numero reale partendo dai dati forniti. Può essere utilizzata per fare previsioni, stime, calcoli statistici. Un esempio sono i sistemi di AI che, in base ai dati satellitari e delle stazioni metereologiche terrestri stimano che al <strong>77,40%</strong> possa piovere in una determinata località ad una determinata ora.</li>
<li>La classificazione viene utilizzata per prevedere le categorie, il risultato di output è finito e limitato. Un esempio sono i sistemi di AI che, in base ai dati satellitari e delle stazioni metereologiche terrestri stimano che una tromba d&rsquo;aria sia di categoria <strong>A</strong> oppure <strong>B</strong>.</li>
</ul>
<h2 id="apprendimento-non-supervisionato">Apprendimento non supervisionato</h2>
<p>L&rsquo;apprendimento non supervisionato funziona con dati che non hanno etichette. L&rsquo;algoritmo deve trovare modelli e struttura nei dati da solo.</p>
<p>Tra le tecniche di apprendimento non supervisionato troviamo:</p>
<ul>
<li>il clustering, ovvero si raggruppano i dati nei cluster (negli insieme) in base alle somiglianze;</li>
<li>gli alberi decisionali, utilizza una struttura ad albero per categorizzare i dati in base a degli attributi dei dati. Le foglie dell&rsquo;albero rappresentano le classi finali in cui sono divisi i dati.</li>
</ul>
<h2 id="teachable-machine">Teachable Machine</h2>
<p><a href="https://teachablemachine.withgoogle.com/" title="Sito web di Teachable Machine">Teachable Machine</a> è un ambiente didattico per apprendere, insegnare e realizzare lavori con l&rsquo;intelligenza artificiale, in un contesto creativo e multimediale.</p>
<p>In questo ambiente possiamo creare progetti che sfruttino il riconoscimento audio, video e della posa del corpo.</p>
<h3 id="riconoscimento-delle-immagini">Riconoscimento delle immagini</h3>
<p>L&rsquo;ambiente guida l&rsquo;utente nella creazione delle categorie da riconoscere, per poi effettuare il training e visualizzare l&rsquo;esito.</p>
<p>Nella parte sinistra dell&rsquo;interfaccia, l&rsquo;utente deve scegliere le categorie di immagini che il sistema di AI dovrà riconoscere e quindi caricare le immagini per ogni categoria.</p>
<p>Cliccando sul pulsante centrale di addestramento, viene effettuato il <strong>training</strong> del sistema di AI, un processo attraverso il quale il computer impara a riconoscere i vari modelli e a catalogarli come indicato dall&rsquo;utente.</p>
<p>Di seguito una schermata d&rsquo;esempio:</p>
<p><img src="/static/coding/web/mediapipe/teachableMachine.png" alt="Teachable Machine"></p>
<p>Sulla destra dell&rsquo;interfaccia si può verificare, attraverso la webcam oppure un&rsquo;immagine caricata, che il sistema effettivamente abbia imparato a catalogare i modelli indicati in fase di training.</p>
<p>Ovviamente se il sistema di AI è stato addestrato su cani e gatti, non potra catalogare delfini o giraffe.</p>
<h3 id="riconoscimento-dellaudio">Riconoscimento dell&rsquo;audio</h3>
<p>Un sistema audio deve tener conto del rumore di fondo, per cui questo tipo di progetti prevede la registrazione di almeno 20 secondi di solo rumore di fondo.</p>
<p><img src="/static/coding/web/mediapipe/teachableMachine-audio-noise.png" alt="Teachable Machine"></p>
<p>I progetti di Teachable Machine non permettono di caricare <code>.mp3</code>, ma solo di registrarli e di scaricarli successivamente per riutilizzarli.</p>
<p>Il processo di catalogazione è simile a quello delle immagini.</p>
<h3 id="riconoscimento-della-posa">Riconoscimento della posa</h3>
<p>Il riconoscimento della posa si basa su sistemi gia addestrati al riconoscimento dei punti del corpo ed a stimare per ogni punto la posizione rispetto all&rsquo;immagine.</p>
<p>Al momento in cui si scrive, il progetto non è esportabile per il linguaggio <code>p5.js</code>.</p>
<p>I sistemi di AI su cui si basa sono due:</p>
<ul>
<li>il sistema <strong>MoveNet</strong> che riconosce 17 punti del corpo e ne fornisce le coordinate in uno spazio 2D;</li>
<li>il sistema <strong>BlazePose</strong> che riconosce 33 punti del corpo e ne fornisce le coordinate in uno spazio 3D di 2 metri cubi.</li>
</ul>
<p><img src="/static/coding/web/mediapipe/bodyPose-Keypoints.png" alt="Teachable Machine"></p>
<p>Cliccando sul pulsante centrale di addestramento, viene effettuato il <strong>training</strong> del sistema di AI, un processo attraverso il quale il computer impara a riconoscere i vari modelli e a catalogarli come indicato dall&rsquo;utente.</p>
<p>Effettuato il training, è possibile revisionare le immagini caricate e visualizzare i punti riconosciuti.</p>
<p><img src="/static/coding/web/mediapipe/teachableMachine-pose-check.png" alt="Teachable Machine"></p>
<p>E&rsquo; consigliabile cancellare le immagini sulle quali non è stato riconosciuto quasi nessun punto ed effettuare nuovamente il training su quelle rimanenti.</p>
<p>Il sistema di AI come da documentazione è utilizzabile nel seguente modo:</p>
<ul>
<li>la funzione <code>bodyPose.detectStart(video, gotPoses);</code> è invocata per il riconoscimento di un modello presente nel video;</li>
<li>la funzione <code>gotPoses(results)</code> è invocata per restituire la posa, in particolare:
<ol>
<li><code>poses[0].keypoints</code> contiene l&rsquo;insieme di punti, ognuno accessibile con la sintassi <code>poses[0].keypoints[0]</code>, <code>poses[0].keypoints[1]</code>, &hellip;, oppure accessibile per nome, come ad esempio <code>poses[0].left_eye</code>, <code>poses[0].right_shoulder</code>;</li>
<li>ogni punto è identificato da una coppia di coordinate (x, y) utilizzabili con entrambe le sintassi evidenziate al punto precedente, sia <code>poses[0].keypoints[0].x</code> e <code>poses[0].keypoints[0].y</code>, sia <code>poses[0].left_eye.x</code> ed <code>poses[0].left_eye.y</code>.</li>
</ol>
</li>
</ul>
<p>In allegato un archivio del progetto in formato compresso con estensione <code>.zip</code>.</p>
<p><a href="/static/coding/web/mediapipe/progettoAI-pose.zip">Progetto di posa</a></p>
<h4 id="lista-punti-noti-per-movenet">Lista punti noti per MoveNet</h4>
<ol start="0">
<li><code>nose</code>;</li>
<li><code>left_eye</code>;</li>
<li><code>right_eye</code>;</li>
<li><code>left_ear</code>;</li>
<li><code>right_ear</code>;</li>
<li><code>left_shoulder</code>;</li>
<li><code>right_shoulder</code>;</li>
<li><code>left_elbow</code>;</li>
<li><code>right_elbow</code>;</li>
<li><code>left_wrist</code>;</li>
<li><code>right_wrist</code>;</li>
<li><code>left_hip</code>;</li>
<li><code>right_hip</code>;</li>
<li><code>left_knee</code>;</li>
<li><code>right_knee</code>;</li>
<li><code>left_ankle</code>;</li>
<li><code>right_ankle</code>;</li>
</ol>
<h4 id="lista-punti-noti-per-blazepose">Lista punti noti per BlazePose</h4>
<ol start="0">
<li><code>nose</code></li>
<li><code>left_eye_inner</code></li>
<li><code>left_eye</code></li>
<li><code>left_eye_outer</code></li>
<li><code>right_eye_inner</code></li>
<li><code>right_eye</code></li>
<li><code>right_eye_outer</code></li>
<li><code>left_ear</code></li>
<li><code>right_ear</code></li>
<li><code>mouth_left</code></li>
<li><code>mouth_right</code></li>
<li><code>left_shoulder</code></li>
<li><code>right_shoulder</code></li>
<li><code>left_elbow</code></li>
<li><code>right_elbow</code></li>
<li><code>left_wrist</code></li>
<li><code>right_wrist</code></li>
<li><code>left_pinky</code></li>
<li><code>right_pinky</code></li>
<li><code>left_index</code></li>
<li><code>right_index</code></li>
<li><code>left_thumb</code></li>
<li><code>right_thumb</code></li>
<li><code>left_hip</code></li>
<li><code>right_hip</code></li>
<li><code>left_knee</code></li>
<li><code>right_knee</code></li>
<li><code>left_ankle</code></li>
<li><code>right_ankle</code></li>
<li><code>left_heel</code></li>
<li><code>right_heel</code></li>
<li><code>left_foot_index</code></li>
<li><code>right_foot_index</code></li>
<li><code>bodyCenter</code></li>
<li><code>forehead</code></li>
<li><code>leftThumb</code></li>
<li><code>leftHand</code></li>
<li><code>rightThumb</code></li>
<li><code>rightHand</code></li>
</ol>
<h3 id="esportazione-del-modello">Esportazione`` del modello</h3>
<p>Nell&rsquo;ambiente di Teachable Machine è possibile esportare il modello addestrato per utilizzarlo nello sviluppo dei propri programmi.</p>
<p>Per esportare un modello, bisogna cliccare sul pulsante &ldquo;Esporta modello&rdquo; e poi scegliere il linguaggio di programmazione tra quelli proposti e se utilizzarlo online o effettuare il download.</p>
<p><img src="/static/coding/web/mediapipe/teachableMachine-export-model.png" alt="Teachable Machine"></p>
<p>Il progetto JavaScript consiste in 4 file, la pagina web ed i tre file del sistema di AI.</p>
<p><img src="/static/coding/web/mediapipe/teachableMachine-project.png" alt="Teachable Machine"></p>
<p>Al momento in cui si scrive, le versioni delle librerie JavaScript sono errate, per poter far funzionare il progetto è necessario sostituirle indicando la versione:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;script src=<span style="color:#009c00">&#34;https://cdn.jsdelivr.net/npm/p5@1.2.0/lib/p5.min.js&#34;</span>&gt;&lt;/script&gt;
</span></span><span style="display:flex;"><span>&lt;script src=<span style="color:#009c00">&#34;https://cdn.jsdelivr.net/npm/p5@0.7.3/lib/addons/p5.dom.min.js&#34;</span>&gt;&lt;/script&gt;
</span></span><span style="display:flex;"><span>&lt;script src=<span style="color:#009c00">&#34;https://unpkg.com/ml5@0.12.2/dist/ml5.min.js&#34;</span>&gt;&lt;/script&gt;
</span></span></code></pre></div><p>Ulteriore attenzione deve essere posta nell&rsquo;indicare la cartella in cui si trovano i file di AI:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">let</span> imageModelURL = <span style="color:#009c00">&#39;./cartella/&#39;</span>;  <span style="color:#f00;font-style:italic">// FIX MODEL PATH
</span></span></span><span style="display:flex;"><span><span style="color:#f00;font-style:italic"></span>
</span></span><span style="display:flex;"><span>classifier = ml5.imageClassifier(imageModelURL + <span style="color:#009c00">&#39;model.json&#39;</span>);
</span></span></code></pre></div><p>Una volta effettuato ciò è necessario avviare un proprio server locale sul quale caricare il progetto (oppure caricarli su un vero e proprio server online) e verificare che il progetto funzioni correttamente.</p>
<p>Il progetto realizzato utilizza il sistema di AI nel seguente modo:</p>
<ul>
<li>la funzione <code>classifier.classify(flippedVideo, gotResult);</code> è invocata per il riconoscimento di un modello presente nell&rsquo;immagine (il video frame corrente);</li>
<li>la funzione <code>gotResult(error, results)</code> è invocata per restituire un errore o una serie di risultati, in particolare:
<ol>
<li><code>results[0].label</code> contiene la catalogazione del modello;</li>
<li><code>results[0].confidence</code> contiene l&rsquo;accuratezza del riconoscimento (in percentuale).</li>
</ol>
</li>
</ul>
<p>Si può quindi personalizzare la logica del progetto in base alla classificazione ottenuta dal sistema di AI, ad esempio nella funzione <code>draw</code> si può aggiungere:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">if</span> (label == <span style="color:#009c00">&#39;Cani&#39;</span>) {
</span></span><span style="display:flex;"><span>  fill(<span style="color:#009c00">&#39;red&#39;</span>);
</span></span><span style="display:flex;"><span>  circle(200, 200, 20);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#00f">if</span> (label == <span style="color:#009c00">&#39;Uccelli&#39;</span>) {
</span></span><span style="display:flex;"><span>  fill(<span style="color:#009c00">&#39;green&#39;</span>);
</span></span><span style="display:flex;"><span>  rect(200, 200, 40, 20);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In allegato un archivio del progetto in formato compresso con estensione <code>.zip</code>.</p>
<p><a href="/static/coding/web/mediapipe/teachableMachine-export-model.zip">Teachable Machine</a></p>
<h2 id="playing-mortal-kombat">Playing Mortal kombat</h2>
<p>Il progetto didattico per utilizzare l&rsquo;AI con mortal kombat al link:</p>
<p><a href="https://github.com/mgechev/mk.js">https://github.com/mgechev/mk.js</a></p>
<p>Il progetto prevede 4 tipi di modalità di gioco:</p>
<ul>
<li><code>basic</code>: un solo giocatore si muove utilizzando la tastiera;</li>
<li><code>multiplayer</code>: due giocatori in movimento utilizzando entrambi la tastiera;</li>
<li><code>network</code>: si gioca online, è necessario avere il server;</li>
<li><code>webcaminput</code>: due giocatori in movimento utilizzando la webcam.</li>
</ul>
<p>Il progetto è presentato dalla pagina web <code>index.html</code> che contiene il codice di avvio del gioco. In particolare in questa pagina è impostata la variabile <code>option</code> che indica la configurazione con la modalità di gioco:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>var options = {
</span></span><span style="display:flex;"><span>  arena: {
</span></span><span style="display:flex;"><span>      container: document.getElementById(&#39;arena&#39;),
</span></span><span style="display:flex;"><span>      arena: mk.arenas.types.THRONE_ROOM
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  fighters: [{ name: &#39;Subzero&#39; }, { name: &#39;Kano&#39; }],
</span></span><span style="display:flex;"><span>  callbacks: { ... }
</span></span><span style="display:flex;"><span>  isHost: &#39;no&#39;,
</span></span><span style="display:flex;"><span>  gameName: &#34;mortalKombat&#34;,
</span></span><span style="display:flex;"><span>  gameType: &#39;basic&#39;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In particolare la variabile <code>gameType</code> indica la modalità di gioco sopra elencate, la variabile <code>isHost</code>si imposta solo se la modalità di gioco è online.</p>
<p>L&rsquo;arena può essere <code>TOWER</code> oppure <code>THRONE_ROOM</code>, mentre i nomi dei combattenti sono indicati.</p>
<p>Il progetto non prevede l&rsquo;utilizzo di <code>p5.js</code> ne di <code>Teachable Machine</code>, ma lo sviluppatore può aggiungere facilmente questa casistica.</p>
<h2 id="struttura-del-codice">Struttura del codice</h2>
<h3 id="controller-del-gioco">Controller del gioco</h3>
<p>Nel file <code>mk.js</code> è definita la funzione di avvio del gioco <code>start()</code> che a seconda della modalità di gioco configurata (nella variabile <code>option.gameType</code>), crea il controller di movimento specifico. La funzione è realizzata in questo modo:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>mk.start = <span style="color:#00f">function</span> (options) {
</span></span><span style="display:flex;"><span>  <span style="color:#00f">var</span> type = options.gameType || <span style="color:#009c00">&#39;basic&#39;</span>,
</span></span><span style="display:flex;"><span>      promise = <span style="color:#00f">new</span> mk.Promise();
</span></span><span style="display:flex;"><span>  type = type.toLowerCase();
</span></span><span style="display:flex;"><span>  <span style="color:#00f">switch</span> (type) {
</span></span><span style="display:flex;"><span>    <span style="color:#00f">case</span> <span style="color:#009c00">&#39;basic&#39;</span>:
</span></span><span style="display:flex;"><span>      mk.game = <span style="color:#00f">new</span> mk.controllers.Basic(options);
</span></span><span style="display:flex;"><span>      <span style="color:#00f">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#00f">case</span> <span style="color:#009c00">&#39;network&#39;</span>:
</span></span><span style="display:flex;"><span>      mk.game = <span style="color:#00f">new</span> mk.controllers.Network(options);
</span></span><span style="display:flex;"><span>      <span style="color:#00f">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#00f">case</span> <span style="color:#009c00">&#39;multiplayer&#39;</span>:
</span></span><span style="display:flex;"><span>      mk.game = <span style="color:#00f">new</span> mk.controllers.Multiplayer(options);
</span></span><span style="display:flex;"><span>      <span style="color:#00f">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#00f">case</span> <span style="color:#009c00">&#39;webcaminput&#39;</span>:
</span></span><span style="display:flex;"><span>      mk.game = <span style="color:#00f">new</span> mk.controllers.WebcamInput(options);
</span></span><span style="display:flex;"><span>      <span style="color:#00f">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#00f">default</span>:
</span></span><span style="display:flex;"><span>      mk.game = <span style="color:#00f">new</span> mk.controllers.Basic(options);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  mk.game.init(promise);
</span></span><span style="display:flex;"><span>  <span style="color:#00f">return</span> promise;
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>E&rsquo; facile intuire che a seconda della modalità di gioco configurata, viene <strong>creato</strong> uno specifico controller del gioco. In particolare il codice è strutturato per <strong>definire</strong> i controller di movimento <code>Base</code>, <code>Basic</code>, <code>WebcamInput</code>, <code>Multiplayer</code> e  <code>Network</code>, ognuno con un metodo <code>prototype()</code> e un metodo <code>prototype._initialize()</code>, di seguito elencati.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>mk.controllers.Base
</span></span><span style="display:flex;"><span>mk.controllers.Basic
</span></span><span style="display:flex;"><span>mk.controllers.Basic.prototype
</span></span><span style="display:flex;"><span>mk.controllers.Basic.prototype._initialize
</span></span><span style="display:flex;"><span>mk.controllers.WebcamInput
</span></span><span style="display:flex;"><span>mk.controllers.WebcamInput.prototype
</span></span><span style="display:flex;"><span>mk.controllers.WebcamInput.prototype._initialize
</span></span><span style="display:flex;"><span>mk.controllers.Multiplayer
</span></span><span style="display:flex;"><span>mk.controllers.Multiplayer.prototype
</span></span><span style="display:flex;"><span>mk.controllers.Multiplayer.prototype._initialize
</span></span><span style="display:flex;"><span>mk.controllers.Network
</span></span><span style="display:flex;"><span>mk.controllers.Network.prototype
</span></span><span style="display:flex;"><span>mk.controllers.Network.prototype._initialize
</span></span></code></pre></div><h3 id="mosse-dei-combattenti">Mosse dei combattenti</h3>
<p>I combattenti sono 2 e sono definiti nell&rsquo;array di gioco chiamato <code>fighters</code>. E&rsquo; possibile indicare il primo o il secondo combattente per posizione: <code>fighters[0]</code> e <code>fighters[1]</code>.</p>
<p>Le &ldquo;mosse&rdquo; che un combattente può effettuare sono definite nel file <code>mk.js</code> nella seguente sezione di codice:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>mk.moves.types = {
</span></span><span style="display:flex;"><span>  STAND              : <span style="color:#009c00">&#39;stand&#39;</span>,
</span></span><span style="display:flex;"><span>  WALK               : <span style="color:#009c00">&#39;walking&#39;</span>,
</span></span><span style="display:flex;"><span>  WALK_BACKWARD      : <span style="color:#009c00">&#39;walking-backward&#39;</span>,
</span></span><span style="display:flex;"><span>  SQUAT              : <span style="color:#009c00">&#39;squating&#39;</span>,
</span></span><span style="display:flex;"><span>  STAND_UP           : <span style="color:#009c00">&#39;stand-up&#39;</span>,
</span></span><span style="display:flex;"><span>  HIGH_KICK          : <span style="color:#009c00">&#39;high-kick&#39;</span>,
</span></span><span style="display:flex;"><span>  JUMP               : <span style="color:#009c00">&#39;jumping&#39;</span>,
</span></span><span style="display:flex;"><span>  FORWARD_JUMP       : <span style="color:#009c00">&#39;forward-jump&#39;</span>,
</span></span><span style="display:flex;"><span>  BACKWARD_JUMP      : <span style="color:#009c00">&#39;backward-jump&#39;</span>,
</span></span><span style="display:flex;"><span>  LOW_KICK           : <span style="color:#009c00">&#39;low-kick&#39;</span>,
</span></span><span style="display:flex;"><span>  LOW_PUNCH          : <span style="color:#009c00">&#39;low-punch&#39;</span>,
</span></span><span style="display:flex;"><span>  HIGH_PUNCH         : <span style="color:#009c00">&#39;high-punch&#39;</span>,
</span></span><span style="display:flex;"><span>  FALL               : <span style="color:#009c00">&#39;fall&#39;</span>,
</span></span><span style="display:flex;"><span>  WIN                : <span style="color:#009c00">&#39;win&#39;</span>,
</span></span><span style="display:flex;"><span>  ENDURE             : <span style="color:#009c00">&#39;endure&#39;</span>,
</span></span><span style="display:flex;"><span>  SQUAT_ENDURE       : <span style="color:#009c00">&#39;squat-endure&#39;</span>,
</span></span><span style="display:flex;"><span>  UPPERCUT           : <span style="color:#009c00">&#39;uppercut&#39;</span>,
</span></span><span style="display:flex;"><span>  SQUAT_LOW_KICK     : <span style="color:#009c00">&#39;squat-low-kick&#39;</span>,
</span></span><span style="display:flex;"><span>  SQUAT_HIGH_KICK    : <span style="color:#009c00">&#39;squat-high-kick&#39;</span>,
</span></span><span style="display:flex;"><span>  SQUAT_LOW_PUNCH    : <span style="color:#009c00">&#39;squat-low-punch&#39;</span>,
</span></span><span style="display:flex;"><span>  KNOCK_DOWN         : <span style="color:#009c00">&#39;knock-down&#39;</span>,
</span></span><span style="display:flex;"><span>  ATTRACTIVE_STAND_UP: <span style="color:#009c00">&#39;attractive-stand-up&#39;</span>,
</span></span><span style="display:flex;"><span>  SPIN_KICK          : <span style="color:#009c00">&#39;spin-kick&#39;</span>,
</span></span><span style="display:flex;"><span>  BLOCK              : <span style="color:#009c00">&#39;blocking&#39;</span>,
</span></span><span style="display:flex;"><span>  FORWARD_JUMP_KICK  : <span style="color:#009c00">&#39;forward-jump-kick&#39;</span>,
</span></span><span style="display:flex;"><span>  BACKWARD_JUMP_KICK : <span style="color:#009c00">&#39;backward-jump-kick&#39;</span>,
</span></span><span style="display:flex;"><span>  BACKWARD_JUMP_PUNCH: <span style="color:#009c00">&#39;backward-jump-punch&#39;</span>,
</span></span><span style="display:flex;"><span>  FORWARD_JUMP_PUNCH : <span style="color:#009c00">&#39;forward-jump-punch&#39;</span>
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>Il metodo per far effettuare una mossa ad un combattente è <code>._moveFighter(f, mossa)</code>, questa funzione prende in input un combattente ed una mossa e realizza l&rsquo;animazione grafica.</p>
<p>Ogni controller definisce un proprio metodo per selezionare la mossa tra le mosse indicate precedentemente, selezionare il combattente dall&rsquo;array indicato precedentemente ed applicare l&rsquo;azione.</p>
<h2 id="aggiungere-p5js-e-teachable-machine">Aggiungere P5JS e Teachable Machine</h2>
<p>Tenendo presente la struttura del codice descritta precedentemente, per aggiungere un controller per P5JS dobbiamo modificare il file <code>mk.js</code> creando:</p>
<ol>
<li>un opzione nel metodo <code>start</code> per <strong>creare</strong> un controller:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">case</span> <span style="color:#009c00">&#39;p5js&#39;</span>:
</span></span><span style="display:flex;"><span>  mk.game = <span style="color:#00f">new</span> mk.controllers.P5JS(options);
</span></span><span style="display:flex;"><span>  <span style="color:#00f">break</span>;
</span></span></code></pre></div><ol start="2">
<li>il controller <code>P5JS</code>, conservando la stessa struttura degli altri controller di gioco:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>mk.controllers.P5JS = <span style="color:#00f">function</span> (options) {
</span></span><span style="display:flex;"><span>  mk.controllers.Basic.call(<span style="color:#00f">this</span>, options);
</span></span><span style="display:flex;"><span>  mk.classifier = options.classifier;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mk.controllers.P5JS.prototype = <span style="color:#00f">new</span> mk.controllers.Basic();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mk.controllers.P5JS.prototype._initialize = <span style="color:#00f">function</span> () {
</span></span><span style="display:flex;"><span>  <span style="color:#00f">this</span>._player = 0;
</span></span><span style="display:flex;"><span>  <span style="color:#00f">this</span>._callbacks.setMK(mk);
</span></span><span style="display:flex;"><span>  <span style="color:#00f">this</span>._callbacks.setP5JS(<span style="color:#00f">this</span>);
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><ol start="3">
<li>il metodo per selezionare la mossa tra le mosse indicate precedentemente, selezionare il combattente dall&rsquo;array indicato precedentemente ed applicare il movimento al combattente:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>mk.controllers.P5JS.prototype.movimento = <span style="color:#00f">function</span> (categoriaAI) {
</span></span><span style="display:flex;"><span>  <span style="color:#f00;font-style:italic">// per ora non fa nulla
</span></span></span><span style="display:flex;"><span><span style="color:#f00;font-style:italic"></span>  <span style="color:#00f">let</span> mossa = mk.moves.types.STAND;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f00;font-style:italic">// se trovo il movimento, lo fa
</span></span></span><span style="display:flex;"><span><span style="color:#f00;font-style:italic"></span>  <span style="color:#00f">if</span> (categoriaAI == <span style="color:#009c00">&#39;pugno&#39;</span>) {
</span></span><span style="display:flex;"><span>    mossa = mk.moves.types.HIGH_PUNCH;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#00f">if</span> (categoriaAI == <span style="color:#009c00">&#39;calcio&#39;</span>) {
</span></span><span style="display:flex;"><span>    mossa = mk.moves.types.HIGH_KICK;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#00f">var</span> self = <span style="color:#00f">this</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#00f">let</span> f = <span style="color:#00f">this</span>.fighters[0];
</span></span><span style="display:flex;"><span>  <span style="color:#00f">this</span>._moveFighter(f, mossa);
</span></span><span style="display:flex;"><span>  <span style="color:#00f">return</span> mossa;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="4">
<li>Creato il controller, dobbiamo modificare il file <code>index.html</code> per aggiungere sia il progetto di <code>p5.js</code> sia quello di <code>Teachable Machine</code>.</li>
</ol>
<p>Aggiungiamo le librerie di p5.js e di AI per farle convivere con <code>mk</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#f00;font-style:italic">&lt;!--  FIX VERSION FOR ALL PATH  --&gt;</span>
</span></span><span style="display:flex;"><span>&lt;script src=<span style="color:#009c00">&#34;https://cdn.jsdelivr.net/npm/p5@1.2.0/lib/p5.min.js&#34;</span>&gt;&lt;/script&gt;
</span></span><span style="display:flex;"><span>&lt;script src=<span style="color:#009c00">&#34;https://cdn.jsdelivr.net/npm/p5@0.7.3/lib/addons/p5.dom.min.js&#34;</span>&gt;&lt;/script&gt;
</span></span><span style="display:flex;"><span>&lt;script src=<span style="color:#009c00">&#34;https://unpkg.com/ml5@0.12.2/dist/ml5.min.js&#34;</span>&gt;&lt;/script&gt;
</span></span></code></pre></div><p>Nello script di Mortal Kombat aggiungiamo le variabili per il gioco e per la modalità specifica di gioco <code>P5JS</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">let</span> mortalKombat;
</span></span><span style="display:flex;"><span><span style="color:#00f">let</span> p5js;
</span></span></code></pre></div><p>Aggiungiamo le funzioni per controllare il gioco dall&rsquo;esterno, tramite configurazione:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">var</span> options = {
</span></span><span style="display:flex;"><span>  arena: {
</span></span><span style="display:flex;"><span>      container: document.getElementById(<span style="color:#009c00">&#39;arena&#39;</span>),
</span></span><span style="display:flex;"><span>      arena: mk.arenas.types.THRONE_ROOM
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  fighters: [{ name: <span style="color:#009c00">&#39;Subzero&#39;</span> }, { name: <span style="color:#009c00">&#39;Kano&#39;</span> }],
</span></span><span style="display:flex;"><span>  callbacks: {
</span></span><span style="display:flex;"><span>      attack: <span style="color:#00f">function</span> (f, o, l) {
</span></span><span style="display:flex;"><span>          <span style="color:#00f">if</span> (o.getName() === <span style="color:#009c00">&#39;kano&#39;</span>) {
</span></span><span style="display:flex;"><span>              setLife($(<span style="color:#009c00">&#39;player2Life&#39;</span>), o.getLife());
</span></span><span style="display:flex;"><span>          } <span style="color:#00f">else</span> {
</span></span><span style="display:flex;"><span>              setLife($(<span style="color:#009c00">&#39;player1Life&#39;</span>), o.getLife());
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      setMK : <span style="color:#00f">function</span>(g) {
</span></span><span style="display:flex;"><span>        mortalKombat = g;
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      setP5JS : <span style="color:#00f">function</span>(g) {
</span></span><span style="display:flex;"><span>        p5js = g;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  isHost: <span style="color:#009c00">&#39;no&#39;</span>,
</span></span><span style="display:flex;"><span>  gameName: <span style="color:#009c00">&#34;mortalKombat&#34;</span>,
</span></span><span style="display:flex;"><span>  gameType: <span style="color:#009c00">&#39;p5js&#39;</span>
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>Aggiungiamo lo script standard di <code>p5.js</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">function</span> setup() {
</span></span><span style="display:flex;"><span>  createCanvas(320, 260);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">function</span> draw() {
</span></span><span style="display:flex;"><span>  background(0);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  circle(200, 200, 20);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Verifichiamo che funzioni aggiungendo l&rsquo;istruzione <code>p5js.movimento(key)</code></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">function</span> draw() {
</span></span><span style="display:flex;"><span>  background(0);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  circle(200, 200, 20);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>A questo punto è necessario aggiungere il riconoscimento dei movimenti con <code>Teachable Machine</code>, incollando il codice necessario ed utilizzando il metodo <code>gotResult(error, results)</code> per recuperare il movimento:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#00f">let</span> categoriaAI = results[0].label;
</span></span><span style="display:flex;"><span><span style="color:#00f">let</span> movimentoMK = p5js.movimento(categoriaAI);
</span></span></code></pre></div><p>Un esempio di progetto è in allegato.</p>

    </div>
  </article>
</main>





<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/coding/web/mediapipe/flappybird/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Precedente</span>
			<p class="pager__title">Esercizi di AI - 05 Flappy Bird</p>
		</a>
	</div>
</nav>
<div class="article-content">

  

</div>


            </div>
            
        </div>
        <footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2025 Lab. informatica.
			<span class="footer__copyright-credits">Generato con <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> e il tema <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a>.</span>
		</div>
	</div>
</footer>
    </div>

<script data-goatcounter="https://codingepaduli-github.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
