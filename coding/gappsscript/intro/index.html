<!DOCTYPE html>
<html class="no-js" lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Lez. 01 - Introduzione a Google App Script - Lab. informatica</title>

    <meta name="description" content="Introduzione a Google App Script">
        <meta property="og:url" content="http://codingepaduli.github.io/coding/gappsscript/intro/">
  <meta property="og:site_name" content="Lab. informatica">
  <meta property="og:title" content="Lez. 01 - Introduzione a Google App Script">
  <meta property="og:description" content="Introduzione a Google App Script">
  <meta property="og:locale" content="it_IT">
  <meta property="og:type" content="article">
    <meta property="article:section" content="coding">
    <meta property="article:published_time" content="2024-10-20T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-20T00:00:00+00:00">
    <meta property="og:image" content="http://codingepaduli.github.io/static/wifi-5.svg">

        
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://codingepaduli.github.io/static/wifi-5.svg">
  <meta name="twitter:title" content="Lez. 01 - Introduzione a Google App Script">
  <meta name="twitter:description" content="Introduzione a Google App Script">



    <link rel="stylesheet" href="/css/style.css">

    
    <link rel="stylesheet" href="/static/css/customTypography.css">
    

    <link rel="icon" href="/favicon.ico">
    <link rel="icon" href="/static/wifi-5.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/static/apple-touch-icon.png">
    <link rel="manifest" href="/static/manifest.webmanifest">

    
        <meta name="keywords" content="coding  programmazione  open-source  sviluppo  web  ">
</head>
<body class="body">
    <div class="container container--outer">
        <header class="header">
	<div class="container header__container">
		
	
	<div class="logo">

    
    <div id="my_logo">

      
      <div>
        <a class="logo__link" href="/" title="Lab. informatica" rel="home">
      		</a>
      </div>

      
      <div class="logo__item">
        <div class="logo__title">
          <a href="/" style="color: #e22d30">
            Lab. informatica
          </a>
        </div>
      </div>




      
      <div>
        

  <div class="menu_button">
    
    <label for="my_menu">
      Menu
      <span></span>
      <span></span>
      <span></span>
    </label>
  </div>

      </div>
    </div>
    

    <style>
       
      #my_logo {
        display: flex;
        justify-content: space-between;  
        align-items: center;  
      }
    </style>

    
    <div class="logo__item logo__text" style="display: block; text-align: center;">
			<div class="logo__tagline" style="color: inherit;">Sito web del laboratorio di informatica</div>
		</div>
  </div>

  

  
  <input type="checkbox" id="my_menu">


		

  <nav class="my_navbar">
    <ul>

      <li><a href="/coding/">Coding</a></li>

      <li><a href="/tools/">Tools</a></li>

      <li><a href="/opensource/">Software open source</a></li>

      <li><a href="/webapp/">Web-App</a></li>

      <li><a href="/interesting/">Link interessanti</a></li>
    </ul>
  </nav>

	</div>
</header>



  <style>
     
    .my_navbar ul {
      display: flex;  
      background-color: black;
      color: white;
    }
    .my_navbar li {
      padding: 0.8rem 1.5rem;
      list-style: none;
      text-transform: uppercase;
      justify-content: center;
    }
    .my_navbar a {
      color: white;
      font-weight: 700;
    }

     
    @media screen and (max-width: 767px) {
      .my_navbar ul {
         flex-direction: column;
         display: none;  
      }

       
       
      #my_menu:checked + .my_navbar ul {
         display: flex;
         text-align: center;
      }
    }
  </style>



  <style>
     
    .menu_button {
      display: none;
    }
    .menu_button label {
      background-color: white;
      color: black;
      border: 2px solid white;
      height: 70px;
      width: 70px;
      display: flex;  
      justify-content: center;
      align-items: center;  
      flex-direction: column;
    }
     
    .menu_button label span {
      background-color: black;
      color: white;
      height: 3px;
      width: 80%;
      margin: 5px 0px;
    }

     
    @media screen and (max-width: 767px) {
      .menu_button {
        display: flex;  
        justify-content: flex-end;  
      }
    }
  </style>



  
  <style>
    #my_menu {
      display: none;  
    }
  </style>


        <div class="wrapper flex">
            <div class="primary">
            
<style>
    :fullscreen {
        overflow-x :hidden;
        overflow-y: hidden;
    }
</style>

<main class="main" role="main">
  <article class="post">
    <header class="post__header">
      
      <div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2024-10-20T00:00:00Z">20-10-2024</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/coding/" rel="category">Coding</a>, <a class="meta__link" href="/categories/gappsscript/" rel="category">GAppsScript</a>
	</span>
</div><div class="meta__item-reading meta__item">
    
	<span class="meta__text">
        Tempo di lettura 3 minuti 
        ( 464 parole)
    </span>
</div></div>
    </header>
<div class="content post__content clearfix">
      <h1 id="01---introduzione-a-google-app-script">01 - Introduzione a Google App Script</h1>
<p>Apps Script ( <a href="https://script.google.com/">https://script.google.com/</a> ) è una piattaforma JavaScript basata su cloud che consente di integrare e automatizzare le attività in tutti i prodotti Google.</p>
<p>Ogni progetto Apps Script utilizza Google Cloud per gestire le autorizzazioni, servizi avanzati e altri dettagli. Per configurare e gestire queste impostazioni, ogni progetto Apps Script ha un progetto Google Cloud associato.</p>
<p>Si può associare uno script di Apps Script ad un prodotto Google, come Google Documenti, Google Fogli o Google Moduli, attraverso il menù &ldquo;estensioni&rdquo; del prodotto:</p>
<p><img src="/static/coding/GAppsScript/GAppsScript-newProject-addScript.png" alt="Nuovo progetto - aggiunta script"></p>
<p>E&rsquo; importante sottolineare che solo i file dei prodotti Google sono associabili agli Apps Script, se si prova ad aprire un file Excel o un file di Word (caricato su Drive ed aperto attraverso un prodotto Google), questa associazione non è disponibile.</p>
<p>Creando o aprendo uno script, l&rsquo;ambiente di lavoro si presenta così:</p>
<p><img src="/static/coding/GAppsScript/GAppsScript-newProject-step1.png" alt="Nuovo progetto - step 1"></p>
<h2 id="concetti">Concetti</h2>
<p><strong>Ambiti di autorizzazione</strong>: Gli utenti devono autorizzare i progetti di script che accedono ai loro dati o agiscono per loro conto. Quando un utente esegue uno script che richiede l&rsquo;autorizzazione per la prima volta nel tempo, la UI presenta una richiesta di avvio del flusso di autorizzazione. Apps Script rileva automaticamente gli ambiti di autorizzazione necessari.</p>
<p>Gli ambiti si vedono nelle informazioni del progetto:</p>
<p><img src="/static/coding/GAppsScript/GAppsScript-newProject-auth.png" alt="Nuovo progetto - ambiti di autorizzazione"></p>
<p><strong>Servizi integrati</strong>: per interagire con i dati utente ed i prodotti Google, Google Apps Script fornisce l&rsquo;interazione attraverso degli oggetti JavaScript globali (simili all&rsquo;oggetto <code>Math</code>). Ogni servizio fornisce almeno un oggetto globale (di primo livello):</p>
<ul>
<li>l&rsquo;oggetto <code>GmailApp</code> per accedere al servizio Gmail;</li>
<li>l&rsquo;oggetto <code>SpreadsheetApp</code> per accedere al servizio Fogli di calcolo;</li>
<li>l&rsquo;oggetto <code>FormApp</code> per accedere al servizio Moduli;</li>
<li>l&rsquo;oggetto <code>DriveApp</code> per accedere al servizio Drive;</li>
<li>l&rsquo;oggetto <code>AdminDirectory</code> per accedere all&rsquo;amministrazione di dispositivi, gruppi, utenti e altre entità del dominio;</li>
<li>Browser</li>
<li>Logger</li>
<li>MimeType</li>
<li>Session</li>
<li>&hellip;</li>
</ul>
<p><strong>Servizi avanzati</strong>: I servizi avanzati funzionano in modo molto simile a servizi integrati, sono esposti allo stesso modo come oggetti globali, ma devono essere attivati prima di poterli utilizzare. Apps Script gestisce automaticamente il flusso di autorizzazione per questi servizi. Sono implementati come dei sottili wrapper che rivestono le API sottostanti e consentono meno configurazioni rispetto alle interfacce HTTP.</p>
<h2 id="primo-progetto">Primo progetto</h2>
<p>Cliccando sul pulsante &ldquo;nuovo progetto&rdquo; si visualizza un nuovo progetto:</p>
<p><img src="/static/coding/GAppsScript/GAppsScript-newProject-step2.png" alt="Nuovo progetto - step 2"></p>
<p>Cliccando su impostazioni si visualizza la schermata seguente:</p>
<p><img src="/static/coding/GAppsScript/GAppsScript-newProject-settings.png" alt="Nuovo progetto - step 2"></p>
<p>E&rsquo; importante impostare le voci relative a:</p>
<ul>
<li>Nome del progetto;</li>
<li>Mostra il file manifest &ldquo;appsscript.json&rdquo; nell&rsquo;editor;</li>
<li>Le proprietà desiderate;</li>
</ul>
<p>Il file manifest <code>appsscript.json</code> si mostra cosi:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;timeZone&#34;</span>: <span style="color:#009c00">&#34;Africa/Abidjan&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;dependencies&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#009c00">&#34;enabledAdvancedServices&#34;</span>: []
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;exceptionLogging&#34;</span>: <span style="color:#009c00">&#34;STACKDRIVER&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;runtimeVersion&#34;</span>: <span style="color:#009c00">&#34;V8&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Per aggiungere i servizi avanzati, nell&rsquo;editor del codice si clicca sul tasto di &ldquo;aggiunta servizi&rdquo; e si sceglie il servizio:</p>
<p><img src="/static/coding/GAppsScript/GAppsScript-newProject-serviziAggiuntivi.png" alt="Nuovo progetto - servizi aggiuntivi"></p>
<p>Una volta aggiunto un servizio aggiuntivo, questo viene aggiunto al file di manifest <code>appsscript.json</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;timeZone&#34;</span>: <span style="color:#009c00">&#34;Africa/Abidjan&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;dependencies&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#009c00">&#34;enabledAdvancedServices&#34;</span>: [{
</span></span><span style="display:flex;"><span>      <span style="color:#009c00">&#34;userSymbol&#34;</span>: <span style="color:#009c00">&#34;AdminDirectory&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#009c00">&#34;version&#34;</span>: <span style="color:#009c00">&#34;directory_v1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#009c00">&#34;serviceId&#34;</span>: <span style="color:#009c00">&#34;admin&#34;</span>
</span></span><span style="display:flex;"><span>    }]
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;exceptionLogging&#34;</span>: <span style="color:#009c00">&#34;STACKDRIVER&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#009c00">&#34;runtimeVersion&#34;</span>: <span style="color:#009c00">&#34;V8&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
    </div>
  </article>
</main>





<div class="article-content">

  

</div>


            </div>
            
        </div>
        <footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 Lab. informatica.
			<span class="footer__copyright-credits">Generato con <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> e il tema <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a>.</span>
		</div>
	</div>
</footer>
    </div>

<script data-goatcounter="https://codingepaduli-github.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</body>
</html>
